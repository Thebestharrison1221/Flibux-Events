<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  <link rel="icon" href="images/logo.png">
  <meta name="description" content="The best Events.">

  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/pages/apply.css">
  <link rel="stylesheet" href="css/pages/event-application.css">

  <title>Flibux Events | Apply</title>
</head>
<body>
    <!--Navbar-->
    <div class="navbar">
        <div class="menu-mobile">
            <a href="index.html">
                <div class="logo">
                    <img src="images/logo.png" alt="Server logo" class="logo-img">
                    <h3 class="server-name">Flibux Events</h3>
                </div>
            </a>

            <div class="hamburger">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>

        <div class="links">
            <a href="index.html" class="link">
                <i class="fa-solid fa-house"></i>
                <span class="link-text">Home</span>
            </a>
            <a href="admin-team.html" class="link">
                <i class="fa-solid fa-users"></i>
                <span class="link-text">Admin-Team</span>
            </a>
            <a href="apply.html" class="link active">
                <i class="fa-solid fa-file-signature"></i>
                <span class="link-text">Apply</span>
            </a>
        </div>
    </div>

  <!--Header-->
  <section id="header">
    <div class="content">
      <div class="info">
        <p class="minecraft-server-ip hidden">Comming Soon</p>
        <h1 class="title hidden">Apply <span>Now!</span></h1>        
      </div>
      <p class="description">
        Do you think you can help us apply now!
      </p>
    </div>
  </section>

  <!--Contacts-->
  <section id="contacts">
    <div class="content">
      <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2 class="section-title">Application form</h2>
        <!-- <button class="apply-btn" onclick="openOverlay()">Event Application</button> -->
      </div>

      <div class="columns">
        <form class="contact-form" id="contact-form">
          <div class="row">
            <label for="name">Minecraft Name *</label>
            <input type="text" id="name" name="name" required>
          </div>
          <div class="row">
            <label for="discord-name">Discord Username *</label>
            <input type="text" id="discord-name" name="discord-name" required>
          </div>
          <div class="row">
            <label for="position">Position *</label>
            <select id="position" name="position" required>
              <option value="developer">Developer</option>
              <option value="builder">Builder</option>
              <option value="designer">Designer</option>
              <option value="event-moderator">Event Moderator</option>
              <option value="discord-moderator">Discord Moderator</option>
            </select>
          </div>
          <div class="row">
            <label for="message">Message *</label>
            <textarea id="message" name="message" required></textarea>
          </div>
          <div class="form-footer">
            <button type="submit">Submit</button>
            <div class="alert"></div>
          </div>
        </form>
      </div>
    </div>
  </section>

  <!-- Overlay -->
  <div class="overlay" id="overlay">
    <div class="overlay-content">
      <h2>Event Application</h2>
      <form id="event-application-form">
        <div class="row">
          <label for="minecraft-username">Minecraft Username</label>
          <input type="text" id="minecraft-username" name="minecraft-username" required>
        </div>
        <div class="row">
          <label for="discord-username">Discord Username</label>
          <input type="text" id="discord-username" name="discord-username" required>
        </div>
        <div class="row">
          <label for="age">Age</label>
          <input type="number" id="age" name="age" min="1" required>
        </div>
        <div class="row">
          <label for="reason">Why should you get into the event?</label>
          <textarea id="reason" name="reason" required></textarea>
        </div>
        <div class="row">
          <label for="java-checkbox">Are you on Java?</label>
          <input type="checkbox" id="java-checkbox" name="java-checkbox">
        </div>
        <div class="row">
          <label for="both-days-checkbox">Can you show up both days?</label>
          <input type="checkbox" id="both-days-checkbox" name="both-days-checkbox">
        </div>
        <button type="submit" class="submit-btn">Submit</button>
      </form>
      <button class="close-btn" onclick="closeOverlay()">Close</button>
    </div>
  </div>

  <!--Footer-->
  <footer id="footer">
    <p class="copyright">&copy; 2024 <span class="Flibux Events-footer">Flibux Events</span>. All rights reserved.</p>
    <div class="social-links">
        <a href="#" class="link tiktok-link"><i class="fa-brands fa-tiktok"></i></a>
        <a href="#" class="link instagram-link"><i class="fa-brands fa-square-instagram"></i></a>
        <a href="#" class="link discord-link-footer"><i class="fa-brands fa-discord"></i></a>
    </div>
  </footer>

  <script src="js/script.js"></script>
  <script src="https://kit.fontawesome.com/cbf5ee59c8.js" crossorigin="anonymous"></script>
  <script>
    document.getElementById('contact-form').addEventListener('submit', function(e) {
      e.preventDefault(); // Prevent the default form submission

      const name = document.getElementById('name').value;
      const discordName = document.getElementById('discord-name').value;
      const position = document.getElementById('position').value;
      const message = document.getElementById('message').value;

        // Helper to decode Base64
        function decodeBase64(encodedString) {
            return atob(encodedString);
        }

        // Replace raw webhook URLs with Base64-encoded strings
        const webhookBase64 = 'aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTM0NTE3OTc5MDIwMTcxNjg3Ny9YbThjS2xaYWd2b3BTMUJGa1dTTThMOVF0MFVLZENDaGctMTJKTUtQd1Rodk1wVFE5YUFBelBSdXp3MUh6cWFzdTBLbw==';

        // Decode Base64 URLs
        const webhookURL = decodeBase64(webhookBase64);
        
      const payload = {
        content: `New Application: <@&1287399494824230942> \n**Minecraft Name:** ${name}\n**Discord Username:** ${discordName}\n**Position:** ${position}\n**Message:** ${message}`
      };

      fetch(webhookURL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      })
      .then(response => {
        if (response.ok) {
          alert('Your application has been sent!');
          // Optionally reset the form
          document.getElementById('contact-form').reset();
        } else {
          alert('There was an error sending your application.');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('There was an error sending your application.');
      });
    });

    document.getElementById('event-application-form').addEventListener('submit', function(e) {
      e.preventDefault(); // Prevent the default form submission

      const minecraftUsername = document.getElementById('minecraft-username').value;
      const discordUsername = document.getElementById('discord-username').value;
      const age = document.getElementById('age').value;
      const reason = document.getElementById('reason').value;
      const isJava = document.getElementById('java-checkbox').checked;
      const canShowUpBothDays = document.getElementById('both-days-checkbox').checked;

        // Helper to decode Base64
        function decodeBase64(encodedString) {
            return atob(encodedString);
        }

        // Replace raw webhook URLs with Base64-encoded strings
        const webhookBase64 = 'aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTM0NTE3OTc5MDIwMTcxNjg3Ny9YbThjS2xaYWd2b3BTMUJGa1dTTThMOVF0MFVLZENDaGctMTJKTUtQd1Rodk1wVFE5YUFBelBSdXp3MUh6cWFzdTBLbw==';

        // Decode Base64 URLs
        const webhookURL = decodeBase64(webhookBase64);

      const payload = {
        content: `New Event Application: <@&1287399494824230942> \n**Minecraft Username:** ${minecraftUsername}\n**Discord Username:** ${discordUsername}\n**Age:** ${age}\n**Reason:** ${reason}\n**On Java:** ${isJava ? 'Yes' : 'No'}\n**Can Show Up Both Days:** ${canShowUpBothDays ? 'Yes' : 'No'}`
      };

      fetch(webhookURL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(payload)
      })
      .then(response => {
        if (response.ok) {
          alert('Your event application has been sent!');
          // Optionally reset the form
          document.getElementById('event-application-form').reset();
          closeOverlay();
        } else {
          alert('There was an error sending your event application.');
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('There was an error sending your event application.');
      });
    });

    function openOverlay() {
      document.getElementById('overlay').style.display = 'flex';
    }

    function closeOverlay() {
      document.getElementById('overlay').style.display = 'none';
    }
  </script>
</body>
</html>